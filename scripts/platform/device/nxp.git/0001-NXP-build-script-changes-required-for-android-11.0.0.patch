From 5bc7776980c7ea23e3384ad4ce90719629866f7b Mon Sep 17 00:00:00 2001
From: mohit <mohit.p@variscite.com>
Date: Wed, 25 Aug 2021 10:44:14 -0700
Subject: [PATCH] NXP: build script changes required for
 android-11.0.0_2.2.0-var01

---
 common/tools/imx-make.sh | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

diff --git a/common/tools/imx-make.sh b/common/tools/imx-make.sh
index dfc906d8..22af4fd8 100755
--- a/common/tools/imx-make.sh
+++ b/common/tools/imx-make.sh
@@ -126,7 +126,7 @@ if [ ${build_bootloader_kernel_flag} -eq 0 ] && [ ${build_android_flag} -eq 0 ];
 fi
 
 # vvcam.ko need build with kernel each time to make sure "insmod vvcam.ko" works
-if [ -n "${build_kernel}" ] && [ ${TARGET_PRODUCT} = "evk_8mp" ]; then
+if [ -n "${build_kernel}" ] && [ ${TARGET_PRODUCT} = "dart_mx8mp" ]; then
     build_vvcam="vvcam";
     build_kernel_module_flag=1;
 fi
@@ -137,10 +137,11 @@ if [ -n "${build_kernel}" ]; then
     build_kernel_module_flag=1;
 fi
 
-product_makefile=`pwd`/`find device/nxp -maxdepth 4 -name "${TARGET_PRODUCT}.mk"`;
+product_makefile=`pwd`/`find device/variscite -maxdepth 4 -name "${TARGET_PRODUCT}.mk"`;
 product_path=${product_makefile%/*}
 soc_path=${product_path%/*}
 nxp_git_path=${soc_path%/*}
+export AARCH64_GCC_CROSS_COMPILE=$ANDROID_BUILD_TOP/prebuilts/gcc/linux-x86/aarch64/gcc-arm-8.3-2019.03-x86_64-aarch64-linux-gnu/bin/aarch64-linux-gnu-
 
 # if uboot is to be compiled, remove the UBOOT_COLLECTION directory
 if [ -n "${build_bootloader}" ]; then
@@ -149,12 +150,12 @@ fi
 
 # redirect standard input to /dev/null to avoid manually input in kernel configuration stage
 soc_path=${soc_path} product_path=${product_path} nxp_git_path=${nxp_git_path} clean_build=${clean_build} \
-    make -C ./ -f ${nxp_git_path}/common/build/Makefile ${parallel_option} \
+    make -C ./ -f ${nxp_git_path}/../nxp/common/build/Makefile ${parallel_option} \
     ${build_bootloader} ${build_kernel} </dev/null || exit
 
 if [ ${build_kernel_module_flag} -eq 1 ]; then
     soc_path=${soc_path} product_path=${product_path} nxp_git_path=${nxp_git_path} clean_build=${clean_build} \
-        make -C ./ -f ${nxp_git_path}/common/build/Makefile ${parallel_option} \
+        make -C ./ -f ${nxp_git_path}/../nxp/common/build/Makefile ${parallel_option} \
         ${build_vvcam} ${build_galcore} ${build_mxmwifi} </dev/null || exit
 fi
 
-- 
2.25.1

